{% extends 'tennis_base.html' %}

{% block head %}
<title>{{ user_name }}'s Tennis Log</title>
{% endblock %}

{% block body %}
<div class="content">
    {% block first_part %}
    {% endblock %}


    <div class="form">
        <form action="{% block form_action %}{% endblock %}?u={{ u }}" method="POST">
            <table>
                <tr style="background-color: lightgrey;">
                    <td>Date:</td>
                    <td><input type="text" name="date" id="date" value="{% block form_date %}{% endblock %}"></td>
                </tr>
                <tr>
                    <td class="user_input">Duration in minutes:</td>
                    <td><input type="text" name="duration" id="duration" value="{% block form_duration %}{% endblock %}" inputmode="numeric"></td>
                </tr>
                <tr>
                    <td class="user_input">Location:</td>
                    <td><input type="text" name="location" id="location" value="{% block form_location %}{% endblock %}"></td>
                </tr>
                <tr>
                    <td class="user_input">Category:</td>
                    <td>
                        <input type="text" name="category" id="category" value="{% block form_category %}{% endblock %}">
                    </td>
                </tr>
                <tr>
                    <td class="user_input">Details:</td>
                    <td><input type="text" name="details" id="details" value="{% block form_details %}{% endblock %}"></td>
                </tr>
            </table>
            <br>
            <div class="container">
                <input class="iphone-button" type="submit" value="Submit">
            </div>
        </form>
    </div>    
</div>

<script>
    // Get today's date
    var today = new Date();
    
    // Format the date as YYYY-MM-DD
    var formattedDate = today.getFullYear() + '-' + (today.getMonth() + 1).toString().padStart(2, '0') + '-' + today.getDate().toString().padStart(2, '0');
    
    // Set the value of the input field with today's date
    if (!document.getElementById('date').value) {
        document.getElementById('date').value = formattedDate;
    }
</script>

<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
<script>
    $(document).ready(function() {
        $('#category').on('focus', function() {
            $(this).autocomplete('search', '');
        });
        $('#category').autocomplete({
            source: function(request, response) {
                $.ajax({
                    url: '/categories',
                    dataType: 'json',
                    data: {
                        term: request.term
                    },
                    success: function(data) {
                        response(data);
                    }
                });
            },
            minLength: 0, // Minimum characters before triggering autocomplete
            select: function(event, ui) {
                $('#category').val(ui.item.value); // Update input value when an option is selected
                return false; // Prevent default behavior of input field
            }
        });
    });

    $(document).ready(function() {
        // Hardcoded array of locations
        var locations = [
            "CP",
            "RHS",
            "RMS",
            "WSC"
        ];

        $('#location').on('focus', function() {
            $(this).autocomplete('search', '');
        });

        $('#location').autocomplete({
            source: locations, // Use the hardcoded array
            minLength: 0, // Minimum characters before triggering autocomplete
            select: function(event, ui) {
                $('#location').val(ui.item.value); // Update input value when an option is selected
                return false; // Prevent default behavior of input field
            }
        });
    });
</script>

    {% block bottom_part %}
    {% endblock %}

{% endblock %}